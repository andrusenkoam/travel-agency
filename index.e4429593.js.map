{"mappings":"AAAA,MAAMA,EAAO,CACXC,WAAYC,SAASC,cAAc,YACnCC,YAAaF,SAASC,cAAc,cACpCE,WAAYH,SAASC,cAAc,WACnCG,WAAYJ,SAASC,cAAc,aAMrCH,EAAKC,WAAWM,iBAAiB,UAOjC,SAA0BC,GACxBA,EAAIC,iBACJ,MAAMC,EAAO,IAAIC,SAASH,EAAII,gBAoBhCC,eAA4BC,GAC1B,MAAMC,EAAM,uCAENC,EAAQF,EAAIG,KAAIJ,MAAMK,IAC1B,MAAMC,QAAaC,MAAM,GAAGL,IAAMG,KAClC,IAAKC,EAAKE,GACR,MAAM,IAAIC,MAAMH,EAAKI,YAGvB,OAAOJ,EAAKK,MAAM,IAGdd,QAAae,QAAQC,WAAWV,GAKtC,OAJqBN,EAClBiB,QAAO,EAACC,OAAEA,KAAwB,cAAXA,IACvBX,KAAI,EAACY,MAAEA,KAAYA,EAAM,I,EA7B5BC,CALkBpB,EACfqB,OAAO,WACPJ,QAAOK,GAAWA,IAClBf,KAAIe,GAAWA,EAAQC,UAGvBC,MAAKrB,MAAMM,IACV,MAAMgB,EAAWhB,EAAKF,KAAI,EAACmB,QAAEA,KAAcA,EAAQ,KAC7CC,QA+BZxB,eAA0BC,GACxB,MAAMwB,EAAW,+BACXC,EAAU,iCAEVvB,EAAQF,EAAIG,KAAIJ,MAAM2B,IAC1B,MAAMC,EAAS,IAAIC,gBAAgB,CACjCC,IAAKJ,EACLK,EAAGJ,IAGCrB,QAAaC,MAAM,GAAGkB,kBAAyBG,KAErD,IAAKtB,EAAKE,GACR,MAAM,IAAIC,MAAMH,EAAKI,YAGvB,OAAOJ,EAAKK,MAAM,IAGdd,QAAae,QAAQC,WAAWV,GAKtC,OAJaN,EACViB,QAAO,EAACC,OAAEA,KAAwB,cAAXA,IACvBX,KAAI,EAACY,MAAEA,KAAYA,G,CArDWgB,CAAWV,GAExCnC,EAAKM,WAAWwC,UAAyBT,EA0D1CpB,KACC,EACE8B,SAASC,OACPA,EACAC,WAAWC,KAAEA,EAAIC,KAAEA,IAErBC,UAAUC,KAAEA,EAAIrB,QAAEA,MAElB,qGAE0BA,2CACAqB,iDAEZH,WAAcC,kCACVA,oCACEH,gCAGvBM,KAAK,GA5EoD,IAEzDC,OAAMC,GAAOC,QAAQC,IAAIF,KACzBG,SAAQ,KACP3D,EAAKI,YAAY0C,UA1BrB,gFA2BI9C,EAAKC,WAAW2D,OAAO,G,IAxB7B5D,EAAKK,WAAWE,iBAAiB,SAEjC,WACEP,EAAKI,YAAYyD,mBAAmB,YANpC,gF","sources":["src/index.js"],"sourcesContent":["const refs = {\n  searchForm: document.querySelector('.js-form'),\n  inputWraper: document.querySelector('.js-wraper'),\n  addCountry: document.querySelector('.js-add'),\n  counryList: document.querySelector('.js-list'),\n};\n\nconst markup =\n  '<input type=\"text\" name=\"country\" placeholder=\"Enter country\" class=\"text\" />';\n\nrefs.searchForm.addEventListener('submit', onSearchBtnClick);\nrefs.addCountry.addEventListener('click', onAddBtnClick);\n\nfunction onAddBtnClick() {\n  refs.inputWraper.insertAdjacentHTML('beforeend', markup);\n}\n\nfunction onSearchBtnClick(evt) {\n  evt.preventDefault();\n  const data = new FormData(evt.currentTarget);\n  const countries = data\n    .getAll('country')\n    .filter(country => country)\n    .map(country => country.trim());\n\n  getCountries(countries)\n    .then(async resp => {\n      const capitals = resp.map(({ capital }) => capital[0]);\n      const weatherService = await getWeather(capitals);\n\n      refs.counryList.innerHTML = createMarkup(weatherService);\n    })\n    .catch(err => console.log(err))\n    .finally(() => {\n      refs.inputWraper.innerHTML = markup;\n      refs.searchForm.reset();\n    });\n}\n\nasync function getCountries(arr) {\n  const URL = 'https://restcountries.com/v3.1/name/';\n\n  const resps = arr.map(async item => {\n    const resp = await fetch(`${URL}${item}`);\n    if (!resp.ok) {\n      throw new Error(resp.statusText);\n    }\n\n    return resp.json();\n  });\n\n  const data = await Promise.allSettled(resps);\n  const countriesObj = data\n    .filter(({ status }) => status === 'fulfilled')\n    .map(({ value }) => value[0]);\n\n  return countriesObj;\n}\n\nasync function getWeather(arr) {\n  const BASE_URL = 'http://api.weatherapi.com/v1';\n  const API_KEY = 'a9b2b5b585064de1aab74606242609';\n\n  const resps = arr.map(async city => {\n    const params = new URLSearchParams({\n      key: API_KEY,\n      q: city,\n    });\n\n    const resp = await fetch(`${BASE_URL}/current.json?${params}`);\n\n    if (!resp.ok) {\n      throw new Error(resp.statusText);\n    }\n\n    return resp.json();\n  });\n\n  const data = await Promise.allSettled(resps);\n  const objs = data\n    .filter(({ status }) => status === 'fulfilled')\n    .map(({ value }) => value);\n\n  return objs;\n}\n\nfunction createMarkup(arr) {\n  return arr\n    .map(\n      ({\n        current: {\n          temp_c,\n          condition: { icon, text },\n        },\n        location: { name, country },\n      }) =>\n        ` <li class=\"country-item\">\n          <div class=\"country-info\">\n            <h2 class=\"country\">${country}</h2>\n            <h3 class=\"capital\">${name}</h3>\n          </div>\n          <img src=\"${icon}\" alt=\"${text}\" />\n          <p>Text info: ${text}</p>\n          <p>Temperature: ${temp_c} C&deg;</p>\n        </li>`\n    )\n    .join('');\n}\n"],"names":["$1f0dc3b9307be026$var$refs","searchForm","document","querySelector","inputWraper","addCountry","counryList","addEventListener","evt","preventDefault","data","FormData","currentTarget","async","arr","URL","resps","map","item","resp","fetch","ok","Error","statusText","json","Promise","allSettled","filter","status","value","$1f0dc3b9307be026$var$getCountries","getAll","country","trim","then","capitals","capital","weatherService","BASE_URL","API_KEY","city","params","URLSearchParams","key","q","$1f0dc3b9307be026$var$getWeather","innerHTML","current","temp_c","condition","icon","text","location","name","join","catch","err","console","log","finally","reset","insertAdjacentHTML"],"version":3,"file":"index.e4429593.js.map"}